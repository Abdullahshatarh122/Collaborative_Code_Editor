(()=>{window.projects=[];let e=null;const t=document.getElementById("openProjectsButton"),n=document.getElementById("projectsPanel"),o=document.getElementById("projectsList"),c=document.getElementById("branchesList"),r=document.getElementById("createProjectButton"),a=document.getElementById("renameModal"),d=document.getElementById("renameProjectInput"),l=document.getElementById("renameProjectConfirm"),s=document.getElementById("closeRenameModal"),i=document.getElementById("createProjectModal"),m=document.getElementById("newProjectNameInput"),p=document.getElementById("newProjectLanguageSelect"),j=document.getElementById("createProjectConfirm"),u=document.getElementById("closeCreateProjectModal");function y(){o.innerHTML="",c.innerHTML="",projects.forEach(((e,t)=>{const n=document.createElement("li");let r=e.name;"java"===e.language?r+=".java":"python"===e.language&&(r+=".py"),n.innerHTML=`\n            <a href="#" onclick="openProjectInIDE(${t})">${r}</a> \n            <div>\n                <button onclick="renameProject(${t})">Rename</button>\n                <button onclick="deleteProject(${t})">Delete</button>\n            </div>\n        `,e.isBranch?c.appendChild(n):o.appendChild(n)}))}document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("closeProjectsPanel");t.addEventListener("click",(function(){n.style.display="block",loadProjects()})),e.addEventListener("click",(function(){n.style.display="none"})),u.addEventListener("click",(()=>{i.style.display="none"})),s.addEventListener("click",(()=>{a.style.display="none"}))})),window.loadProjects=function(){fetch("/api/projects/userProjects").then((e=>e.json())).then((e=>{console.log(e),projects=e,y()})).catch((e=>console.error("Error loading projects:",e)))},r.addEventListener("click",(()=>{i.style.display="flex"})),j.addEventListener("click",(()=>{const e=m.value,t=p.value;e?fetch("/api/projects/createNewProject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,language:t})}).then((e=>e.json())).then((e=>{projects.push(e),loadProjects(),i.style.display="none"})).catch((e=>console.error("Error creating project:",e))):alert("Please provide the project name.")})),window.renameProject=t=>{e=t,d.value=projects[t].name,a.style.display="flex"},l.addEventListener("click",(()=>{const t=d.value;if(t){const n=projects[e].id;fetch(`/api/projects/rename/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({newName:t})}).then((e=>e.ok?(a.style.display="none",loadProjects(),e.json()):e.json().then((e=>{throw new Error(e.message)})))).catch((e=>{console.error("Error renaming project:",e)}))}})),deleteProject=e=>{if(confirm("Are you sure you want to delete this project?")){const t=projects[e].id;fetch(`/api/projects/delete/${t}`,{method:"DELETE"}).then((()=>{projects.splice(e,1),y()})).catch((e=>console.error("Error deleting project:",e)))}}})();